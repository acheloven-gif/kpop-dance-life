#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import os

# Change to the correct directory
os.chdir(r'c:\Users\2ой пользователь\kpop 1.4')

# Read the file
with open('game/src/context/GameContext.tsx', 'r', encoding='utf-8') as f:
    content = f.read()

# List of problematic strings to fix
fixes = {
    # Comments with broken encoding
    'РќР° Р·Р°РіСЂСѓР·РєРµ СЃС‚СЂР°РЅРёС†С‹ вЂ" РџРћР›РќР«Р™ РЎР'Р РћРЎ РїСЂРѕРіСЂРµСЃСЃР° (РєР°Рє С‚СЂРµР±СѓРµС‚ РўР—), РєСЂРѕРјРµ С‚РµРјС‹': 'На загрузке страницы — ПОЛНЫЙ ВВОЗ прогресса (как требует ТЗ), кроме темы',
    'РЎРѕС…СЂР°РЅСЏРµРј С‚РѕР»СЊРєРѕ С‚РµРјСѓ, СЃРєРѕСЂРѕСЃС‚СЊ РІСЃРµРіРґР° СЃР±СЂР°СЃС‹РІР°РµС‚СЃСЏ РЅР° 1, РІСЃС' РѕСЃС‚Р°Р»СЊРЅРѕРµ СЃР±СЂР°СЃС‹РІР°РµРј': 'Сохраняем только тему, скорость всегда сбрасывается на 1, всё остальное сбрасываем',
    'Р"РµРЅРµСЂРёСЂСѓРµРј Р·Р°РЅРѕРІРѕ NPCs Рё teams РїСЂРё РєР°Р¶РґРѕР№ Р·Р°РіСЂСѓР·РєРµ (СЃРёРЅС…СЂРѕРЅРёР·РёСЂРѕРІР°РЅРЅРѕ)': 'Генерируем заново NPCs и teams при каждой загрузке (синхронизировано)',
    'Р"РµРЅРµСЂРёСЂСѓРµРј Р·Р°РЅРѕРІРѕ РїСЂРѕРµРєС‚С‹ РїСЂРё РєР°Р¶РґРѕР№ Р·Р°РіСЂСѓР·РєРµ': 'Генерируем заново проекты при каждой загрузке',
    'РђРєС‚РёРІРЅС‹Рµ РїСЂРѕРµРєС‚С‹ РІСЃРµРіРґР° РЅР°С‡РёРЅР°СЋС‚ РїСѓСЃС‚Рѕ': 'Активные проекты всегда начинают пусто',
    'Р—Р°РІРµСЂС€С'РЅРЅС‹Рµ РїСЂРѕРµРєС‚С‹ РІСЃРµРіРґР° РЅР°С‡РёРЅР°СЋС‚ РїСѓСЃС‚Рѕ (РЅРѕРІР°СЏ РёРіСЂР°)': 'Завершённые проекты всегда начинают пусто (новая игра)',
    'РЅРµРґР°РІРЅРѕ Р·Р°РІРµСЂС€С'РЅРЅС‹Р№ РїСЂРѕРµРєС‚ РґР»СЏ РїРѕРєР°Р·Р° РїРѕРїР°РїР°': 'недавно завершённый проект для показа попапа',
    'РЅРµРґР°РІРЅРµРµ СЃРѕР±С‹С‚РёРµ РґР»СЏ РїРѕРєР°Р·Р° РїРѕРїР°РїР°': 'недавнее событие для показа попапа',
    'Р¤Р»Р°Рі РґР»СЏ РѕС‚СЃР»РµР¶РёРІР°РЅРёСЏ Р·Р°РІРµСЂС€РµРЅРёСЏ РёРіСЂС‹': 'Флаг для отслеживания завершения игры',
}

# Apply fixes
count = 0
for broken, fixed in fixes.items():
    if broken in content:
        content = content.replace(broken, fixed)
        count += 1
        print(f'Fixed: {broken[:50]}... -> {fixed[:50]}...')

# Write back
with open('game/src/context/GameContext.tsx', 'w', encoding='utf-8') as f:
    f.write(content)

print(f'\nTotal fixes applied: {count}')
